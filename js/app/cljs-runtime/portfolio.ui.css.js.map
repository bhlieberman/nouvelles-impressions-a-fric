{"version":3,"sources":["portfolio/ui/css.cljs"],"mappings":"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","names":["portfolio.ui.css/find-link-by-href","el","path","cljs.core.array_seq","p1__29709#","cljs.core.filter","clojure.string/includes?","cljs.core/first","var_args","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","portfolio.ui.css/create-css-link","p__29717","vec__29718","map__29721","cljs.core.nth","cljs.core/--destructure-map","cljs.core.get","seq29713","G__29715","cljs.core/next","self__5754__auto__","media","link","js/document.createElement","portfolio.ui.css/reload-css-file","file","seq__29733","cljs.core/seq","chunk__29734","count__29735","i__29736","temp__5804__auto__","cljs.core/chunked-seq?","c__5568__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","iframe","js/document.body","iframe-head","G__29754","G__29758","original","reloaded","js/Date","_","parent","G__29755","G__29763","done","portfolio.ui.css/load-css-files","paths","seq__29773","chunk__29774","count__29775","i__29776","js/document.head","portfolio.ui.css.create_css_link","portfolio.ui.css/on-head-mutation","mutations","cljs.core/set","seq__29808","chunk__29810","count__29811","i__29812","p1__29803#","cljs.core.mapcat","p1__29805#","cljs.core.comp","p1__29806#","cljs.core.map","p1__29807#","cljs.core/second","cljs.core/re-find","portfolio.ui.css/watch-css-reloads","observer","js/MutationObserver","ms","portfolio.ui.css/replace-loaded-css-files","seq__29827","chunk__29828","count__29829","i__29830","head","G__29957","G__30063","seq__29969","chunk__29970","count__29971","i__29972","seq__30065","chunk__30066","count__30067","i__30068","p1__29820#","seq__30036","chunk__30037","count__30038","i__30039","seq__30092","chunk__30093","count__30094","i__30095"],"sourcesContent":["(ns portfolio.ui.css\n  (:require [clojure.string :as str]))\n\n(defn find-link-by-href [el path]\n  (->> (.querySelectorAll el \"link\")\n       array-seq\n       (filter #(str/includes? (.-href %) path))\n       first))\n\n(defn create-css-link [path & [{:keys [media]}]]\n  (let [link (js/document.createElement \"link\")]\n    (set! (.-href link) path)\n    (set! (.-rel link) \"stylesheet\")\n    (set! (.-type link) \"text/css\")\n    (set! (.-portfolio link) \"portfolio\")\n    (when media\n      (set! (.-media link) media))\n    link))\n\n(defn reload-css-file [file]\n  (doseq [iframe (array-seq (.querySelectorAll js/document.body \"iframe\"))]\n    (let [iframe-head (some-> iframe .-contentWindow .-document .-head)\n          original (find-link-by-href iframe-head file)\n          reloaded (create-css-link (str file \"?\" (.getTime (js/Date.))))]\n      (.addEventListener\n       reloaded\n       \"load\"\n       (fn done [_]\n         (when-let [parent (some-> original .-parentNode)]\n           (.removeChild parent original))\n         (.removeEventListener reloaded \"load\" done)))\n      (.appendChild iframe-head reloaded))))\n\n(defn load-css-files [paths]\n  ;; Figwheel and shadow-cljs only reload CSS files loaded in the document. To\n  ;; avoid user CSS files skewing the Portfolio UI design, the files are loaded\n  ;; with a bogus media attribute.\n  (doseq [path paths]\n    (when-not (find-link-by-href js/document.head path)\n      (.appendChild js/document.head (create-css-link path {:media \"portfolio\"})))))\n\n(defn on-head-mutation [mutations paths]\n  (let [paths (set paths)]\n    (doseq [path (->> mutations\n                      (mapcat #(.-addedNodes %))\n                      (filter (comp #{\"LINK\"} #(.-tagName %)))\n                      (map #(.-href %))\n                      (map #(second (re-find #\"(?:https?://[^/]+)?([^\\?]+)\" %)))\n                      (filter paths))]\n      (reload-css-file path))))\n\n(defn watch-css-reloads [paths]\n  (let [observer (js/MutationObserver.\n                  (fn [ms]\n                    (on-head-mutation ms paths)))]\n    (.observe\n     observer\n     js/document.head\n     #js {:attributes true\n          :subtree true\n          :childList true})\n    observer))\n\n(defn replace-loaded-css-files [paths]\n  (doseq [iframe (array-seq (.querySelectorAll js/document.body \"iframe\"))]\n    (let [head (some-> iframe .-contentWindow .-document .-head)]\n      (doseq [link (->> (.querySelectorAll head \"link\")\n                        array-seq\n                        (filter #(.-portfolio %)))]\n        (-> link .-parentNode (.removeChild link)))\n      (doseq [path paths]\n        (.appendChild head (create-css-link path))))))\n"],"x_google_ignoreList":[0]}